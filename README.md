# Analysis of CNN Architectures for the Prediction of PET-like Structures in CT Images

This repository contains the Python and MatLab scripts written for the research thesis "Analysis of Convolutional Neural Network Architectures for the Prediction of PET-like Structures in CT Images".

### Abstract
The use of PET / CT in diagnostics provides a high clinical value as both the anatomy and metabolic processes can be assessed. Especially the uptake behavior within a tumor is of high relevance in treatment planning and estimation of therapeutic outcomes. However, conducting a PET / CT scan is an expensive and time-consuming procedure. Additionally, the patient gets exposed to a signiﬁcant amount of radiation. One idea to close the gap between the need to acquire PET images and the wish to refrain from performing the scan is the use of Neural Networks. 

The goal of this thesis is to predict the PET uptake behavior from provided CT images using Convolutional Neural Networks (CNNs). The used dataset consists of clinical 18 F-ﬂuordesoxyglucose-PET / CT images from 202 patients, all suffering from a primary lung tumor. The ﬁrst approach works on class labels that are based on the Standardized Uptake Value (SUV) in a binary classiﬁcation task. Three different CNN architectures are presented and analyzed, all working with 2D image patches of size 8x8 px as input data. The second approach works on 3D CT patches of size 6x13x13 px and generates synthetic PET patches of size 11x5x5 px. The predicted PET patches are compared to the ground truth patches of the dataset to rate the performance of the CNN. A preselection of suited pairs of CT and PET patches based on Mutual Information is performed.

The results of the presented architectures are generally promising, yet offer room for improvement. The CNN architectures of the ﬁrst approach do not seem to be powerful enough as the maximum recall was only 0.4755. The small patch size as well as the imbalance of the dataset emerged as challenges that could not be overcome with the analyzed networks. The second approach, exploiting the 3D properties of the imaging modalities, seems more promising. The difficulty was to ﬁnd suitable metrics to measure the performance. The similarity metrics Mean Structural Similarity Index (MSSIM), PSNR (Peak Signal-To-Noise Ratio) and Mean Square Error (MSE) were chosen and analyzed for different hyperparameter combinations. The best result was achieved using Mean Absolute Error as loss, a batch size of 32 and a learning rate of γ = 0 . 0001, leading to an MSSIM of 33.05%. A visual inspection of the predicted PET patches revealed the di ﬃ culty of using a quantitative measure for the assessment of image quality as perceived by human observers.

Future works on predicting PET-like structures in CT images could cover deeper networks or the use of other 3D patching approaches to provide a more suitable input to the CNN. Moreover, increasing the amount of available data can aid in a better prediction of the
desired synthetic PET images.
